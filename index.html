<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>CortexLuma AI</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
body { font-family:'Inter',sans-serif; background:linear-gradient(135deg,#0f172a 0%,#1e293b 100%); display:flex; align-items:center; justify-content:center; height:100vh; color:#e2e8f0; }
::-webkit-scrollbar { width:8px; } ::-webkit-scrollbar-thumb { background:#475569; border-radius:6px; } ::-webkit-scrollbar-thumb:hover { background:#64748b; }
@keyframes fadeInUp { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:translateY(0); } }
.chat-bubble { animation: fadeInUp 0.3s ease; }
#chat-input { transition: all 0.2s ease; } #chat-input:focus { box-shadow: 0 0 10px rgba(99,102,241,0.5); border-color:#6366f1; }
#send-button:hover { transform:scale(1.05); box-shadow:0 0 10px rgba(99,102,241,0.6); } #send-button:active { transform:scale(0.95); }
.chat-box { background-color:rgba(15,23,42,0.8); backdrop-filter:blur(10px); border:1px solid rgba(99,102,241,0.15); border-radius:1rem; }
</style>
</head>
<body>
<div class="max-w-2xl w-full mx-auto p-4">
<header class="text-center mb-4">
<h1 class="text-3xl font-bold text-indigo-400 animate-pulse">CortexLuma AI</h1>
<p class="text-slate-400 mt-1">Your Smart ChatGPT Jr Assistant ðŸ¤–</p>
</header>

<div id="chat-messages" class="chat-box p-4 h-[70vh] overflow-y-auto mb-4 flex flex-col space-y-4 shadow-xl">
<div class="flex justify-start">
<div class="bg-slate-700 p-3 rounded-xl max-w-xs md:max-w-lg text-sm shadow chat-bubble">
Hey there ðŸ‘‹ Iâ€™m <span class="text-indigo-400 font-semibold">CortexLuma</span> â€” your AI buddy. How can I help?
</div>
</div>
</div>

<form id="chat-form" class="flex flex-col space-y-2">
<div class="relative flex items-center">
<textarea id="chat-input" class="flex-1 p-3 pr-12 bg-slate-800 border border-slate-700 rounded-lg text-slate-200 resize-none focus:outline-none focus:ring-2 focus:ring-indigo-500 transition duration-150 overflow-hidden" rows="1" placeholder="Send a message..." style="min-height:44px; max-height:200px;"></textarea>
<button type="submit" id="send-button" class="absolute right-3 bottom-2 bg-indigo-600 hover:bg-indigo-700 text-white p-2 rounded-full transition">
<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
<path d="M3.105 2.548A2.25 2.25 0 0 0 .5 4.675v9.5c0 1.054.912 1.908 1.996 1.908h.084l.875 1.167a.75.75 0 0 0 1.173.044l.897-.978 10.63-7.589c.866-.62.866-1.927 0-2.547L6.53 1.359a.75.75 0 0 0-1.173.044l-.897.978-.084.108Z"/>
<path d="M10.873 9.75V7.5a.75.75 0 0 0-1.5 0v2.25H6.75a.75.75 0 0 0 0 1.5h2.623v2.25a.75.75 0 0 0 1.5 0v-2.25h2.623a.75.75 0 0 0 0-1.5h-2.623Z"/>
</svg>
</button>
</div>
<div id="error-message" class="text-red-400 text-sm h-4"></div>
</form>
</div>

<script>
const chatForm = document.getElementById('chat-form');
const chatInput = document.getElementById('chat-input');
const chatMessages = document.getElementById('chat-messages');
const errorMessage = document.getElementById('error-message');
const sendButton = document.getElementById('send-button');
const BACKEND_URL = "https://cortexluma-backend.onrender.com/api/chat";
let isLoading = false;

function setLoading(state){
isLoading = state;
sendButton.disabled = state;
chatInput.disabled = state;
errorMessage.textContent='';
}

function addMessage(sender,text){
const wrapper=document.createElement('div');
wrapper.className=`flex ${sender==='user'?'justify-end':'justify-start'}`;
const bubble=document.createElement('div');
bubble.className=`p-3 rounded-xl max-w-xs md:max-w-lg text-sm shadow-md transition duration-300 ease-in-out ${sender==='user'?'bg-slate-600 rounded-br-none text-slate-100':'bg-indigo-600 rounded-tl-none text-white'}`;
bubble.innerHTML=text.replace(/\n/g,'<br>');
wrapper.appendChild(bubble);
chatMessages.appendChild(wrapper);
chatMessages.scrollTop=chatMessages.scrollHeight;
return bubble;
}

async function getAiResponse(prompt){
setLoading(true);
const placeholder=addMessage('ai','...');
try{
const response=await fetch(BACKEND_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({message:prompt})});
if(!response.ok) throw new Error(`Backend Status ${response.status}`);
const data=await response.json();
placeholder.innerHTML=data.reply || "ðŸ¤– No response received.";
}catch(e){console.error(e); placeholder.innerHTML=`<span class="text-red-400 font-bold">Error:</span> ${e.message}`;}
finally{setLoading(false); chatInput.focus(); chatMessages.scrollTop=chatMessages.scrollHeight;}
}

chatForm.addEventListener('submit',e=>{
e.preventDefault();
const prompt=chatInput.value.trim();
if(prompt && !isLoading){addMessage('user',prompt); getAiResponse(prompt); chatInput.value=''; chatInput.style.height='auto';}
});

chatInput.addEventListener('input',()=>{chatInput.style.height='auto'; chatInput.style.height=(chatInput.scrollHeight)+'px';});
chatInput.addEventListener('keydown',e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();chatForm.dispatchEvent(new Event('submit'));}});
</script>
</body>
</html>
